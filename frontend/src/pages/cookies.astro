---
// src/pages/cookies.astro
import Layout from '../layouts/Layout.astro'
import LegalSection from '../components/ui/LegalSection.vue'
import { BUSINESS_INFO } from '../utils/constants'

const pageTitle = 'Cookie Policy'
const pageDescription = `Cookie policy for ${BUSINESS_INFO.name}. Learn how we use cookies and similar technologies to improve your browsing experience.`

// Get Google Analytics ID from environment variables
const GA_MEASUREMENT_ID = import.meta.env.PUBLIC_GA_MEASUREMENT_ID || 'GA_MEASUREMENT_ID'
---

<Layout title={pageTitle} description={pageDescription}>
  <main class="min-h-screen bg-white">
    <!-- Header Section -->
    <section class="bg-gradient-to-br from-blue-50 to-indigo-100 py-16">
      <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="text-center">
          <h1 class="text-4xl md:text-5xl font-bold text-gray-900 mb-6">
            üç™ Cookie Policy
          </h1>
          <p class="text-xl text-gray-600 max-w-3xl mx-auto">
            Understanding how we use cookies and similar technologies to enhance your experience on our website.
          </p>
          <div class="mt-6 text-sm text-gray-500">
            Last updated: {new Date().toLocaleDateString('en-GB', { 
              year: 'numeric', 
              month: 'long', 
              day: 'numeric' 
            })}
          </div>
        </div>
      </div>
    </section>

    <!-- Content Sections -->
    <section class="py-12">
      <div class="max-w-4xl mx-auto px-4 sm:px-6 lg:px-8">
        <div class="space-y-12">
          
          <!-- Section 1: What Are Cookies -->
          <LegalSection 
            client:load
            id="what-are-cookies"
            title="1. What Are Cookies?"
            icon="üç™"
            highlight={true}
          >
            <p>
              Cookies are small text files that are placed on your computer or mobile device when you visit a website. They are widely used to make websites work more efficiently and provide information to website owners.
            </p>
            
            <div class="bg-amber-50 border border-amber-200 rounded-lg p-6 my-6">
              <h4 class="text-amber-800 font-semibold mb-3">üîç Cookie Basics</h4>
              <ul class="text-amber-700 space-y-2">
                <li><strong>Size:</strong> Cookies are very small files, typically only a few bytes</li>
                <li><strong>Storage:</strong> They are stored in your browser's cookie folder</li>
                <li><strong>Function:</strong> They help websites remember information about your visit</li>
                <li><strong>Security:</strong> They cannot access other files on your computer or install viruses</li>
              </ul>
            </div>

            <h3>Types of Cookie Technologies</h3>
            <p>We may use various cookie technologies including:</p>
            <ul>
              <li><strong>HTTP Cookies:</strong> Standard cookies stored by your browser</li>
              <li><strong>Local Storage:</strong> Browser storage for larger amounts of data</li>
              <li><strong>Session Storage:</strong> Temporary storage that expires when you close your browser</li>
              <li><strong>Web Beacons:</strong> Small images that help us track email opens and website usage</li>
            </ul>
          </LegalSection>

          <!-- Section 2: Why We Use Cookies -->
          <LegalSection 
            client:load
            id="why-we-use-cookies"
            title="2. Why We Use Cookies"
            icon="üéØ"
          >
            <p>
              We use cookies for several important purposes to improve your experience on our website:
            </p>

            <div class="grid md:grid-cols-2 gap-6 my-6">
              <div class="bg-blue-50 border border-blue-200 rounded-lg p-6">
                <h4 class="text-blue-800 font-semibold mb-3">üîß Essential Functions</h4>
                <ul class="text-blue-700 space-y-1 text-sm">
                  <li>‚Ä¢ Remember your preferences</li>
                  <li>‚Ä¢ Keep you logged in</li>
                  <li>‚Ä¢ Secure form submissions</li>
                  <li>‚Ä¢ Load balancing</li>
                </ul>
              </div>
              
              <div class="bg-green-50 border border-green-200 rounded-lg p-6">
                <h4 class="text-green-800 font-semibold mb-3">üìä Analytics & Improvement</h4>
                <ul class="text-green-700 space-y-1 text-sm">
                  <li>‚Ä¢ Understand site usage</li>
                  <li>‚Ä¢ Track popular content</li>
                  <li>‚Ä¢ Identify technical issues</li>
                  <li>‚Ä¢ Improve performance</li>
                </ul>
              </div>
            </div>

            <h3>Legitimate Interests</h3>
            <p>
              Our use of cookies is based on legitimate interests in providing you with a functional, 
              secure, and optimized website experience. We always aim to balance our interests with 
              your privacy rights.
            </p>
          </LegalSection>

          <!-- Section 3: Types of Cookies We Use -->
          <LegalSection 
            client:load
            id="cookie-types"
            title="3. Types of Cookies We Use"
            icon="üìã"
          >
            <div class="space-y-6">
              
              <!-- Essential Cookies -->
              <div class="border border-gray-200 rounded-lg p-6">
                <div class="flex items-center mb-4">
                  <span class="bg-red-100 text-red-800 px-3 py-1 rounded-full text-sm font-medium mr-3">
                    Always Active
                  </span>
                  <h4 class="text-lg font-semibold">üîí Essential Cookies</h4>
                </div>
                <p class="text-gray-600 mb-4">
                  These cookies are necessary for the website to function and cannot be switched off.
                </p>
                <div class="overflow-x-auto">
                  <table class="min-w-full border border-gray-200 rounded-lg">
                    <thead class="bg-gray-50">
                      <tr>
                        <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Cookie Name</th>
                        <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Purpose</th>
                        <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Duration</th>
                      </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-200">
                      <tr>
                        <td class="px-4 py-2 text-sm font-mono">astro-session</td>
                        <td class="px-4 py-2 text-sm">Maintains your session state</td>
                        <td class="px-4 py-2 text-sm">Session</td>
                      </tr>
                      <tr>
                        <td class="px-4 py-2 text-sm font-mono">csrf-token</td>
                        <td class="px-4 py-2 text-sm">Prevents cross-site request forgery</td>
                        <td class="px-4 py-2 text-sm">Session</td>
                      </tr>
                      <tr>
                        <td class="px-4 py-2 text-sm font-mono">cookie-consent</td>
                        <td class="px-4 py-2 text-sm">Stores your cookie preferences</td>
                        <td class="px-4 py-2 text-sm">365 days</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>

              <!-- Analytics Cookies -->
              <div class="border border-gray-200 rounded-lg p-6">
                <div class="flex items-center mb-4">
                  <span class="bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium mr-3">
                    Optional
                  </span>
                  <h4 class="text-lg font-semibold">üìä Analytics Cookies</h4>
                </div>
                <p class="text-gray-600 mb-4">
                  Help us understand how visitors interact with our website.
                </p>
                <div class="overflow-x-auto">
                  <table class="min-w-full border border-gray-200 rounded-lg">
                    <thead class="bg-gray-50">
                      <tr>
                        <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Cookie Name</th>
                        <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Purpose</th>
                        <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Duration</th>
                      </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-200">
                      <tr>
                        <td class="px-4 py-2 text-sm font-mono">_ga</td>
                        <td class="px-4 py-2 text-sm">Google Analytics user identification</td>
                        <td class="px-4 py-2 text-sm">2 years</td>
                      </tr>
                      <tr>
                        <td class="px-4 py-2 text-sm font-mono">_ga_*</td>
                        <td class="px-4 py-2 text-sm">Google Analytics session information</td>
                        <td class="px-4 py-2 text-sm">2 years</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>

              <!-- Performance Cookies -->
              <div class="border border-gray-200 rounded-lg p-6">
                <div class="flex items-center mb-4">
                  <span class="bg-green-100 text-green-800 px-3 py-1 rounded-full text-sm font-medium mr-3">
                    Optional
                  </span>
                  <h4 class="text-lg font-semibold">‚ö° Performance Cookies</h4>
                </div>
                <p class="text-gray-600 mb-4">
                  Used to enhance the performance and functionality of our website.
                </p>
                <div class="overflow-x-auto">
                  <table class="min-w-full border border-gray-200 rounded-lg">
                    <thead class="bg-gray-50">
                      <tr>
                        <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Cookie Name</th>
                        <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Purpose</th>
                        <th class="px-4 py-2 text-left text-sm font-medium text-gray-700">Duration</th>
                      </tr>
                    </thead>
                    <tbody class="divide-y divide-gray-200">
                      <tr>
                        <td class="px-4 py-2 text-sm font-mono">performance_id</td>
                        <td class="px-4 py-2 text-sm">Track page load times</td>
                        <td class="px-4 py-2 text-sm">30 days</td>
                      </tr>
                    </tbody>
                  </table>
                </div>
              </div>

            </div>
          </LegalSection>

          <!-- Section 4: Managing Your Cookies -->
          <LegalSection 
            client:load
            id="managing-cookies"
            title="4. Managing Your Cookie Preferences"
            icon="‚öôÔ∏è"
            highlight={true}
          >
            <p>
              You have control over the cookies we use on our website. Here's how you can manage your preferences:
            </p>

            <div class="bg-gradient-to-r from-blue-50 to-indigo-50 border border-blue-200 rounded-lg p-6 my-6">
              <h4 class="text-blue-800 font-semibold mb-3">üéõÔ∏è Cookie Settings</h4>
              <p class="text-blue-700 mb-4">
                Use our cookie preference center to customize your settings:
              </p>
              <button 
                class="bg-blue-600 text-white px-6 py-3 rounded-lg hover:bg-blue-700 transition-colors font-medium"
                onclick="openCookieModal()"
              >
                Open Cookie Settings
              </button>
            </div>

            <h3>Browser Settings</h3>
            <p>You can also control cookies through your browser settings:</p>
            
            <div class="grid md:grid-cols-2 gap-4 my-6">
              <div class="border border-gray-200 rounded-lg p-4">
                <h4 class="font-semibold mb-2">üåç Chrome</h4>
                <p class="text-sm text-gray-600">Settings ‚Üí Privacy and Security ‚Üí Cookies and other site data</p>
              </div>
              
              <div class="border border-gray-200 rounded-lg p-4">
                <h4 class="font-semibold mb-2">ü¶ä Firefox</h4>
                <p class="text-sm text-gray-600">Options ‚Üí Privacy & Security ‚Üí Cookies and Site Data</p>
              </div>
              
              <div class="border border-gray-200 rounded-lg p-4">
                <h4 class="font-semibold mb-2">üì± Safari</h4>
                <p class="text-sm text-gray-600">Preferences ‚Üí Privacy ‚Üí Manage Website Data</p>
              </div>
              
              <div class="border border-gray-200 rounded-lg p-4">
                <h4 class="font-semibold mb-2">üìò Edge</h4>
                <p class="text-sm text-gray-600">Settings ‚Üí Cookies and site permissions ‚Üí Cookies and site data</p>
              </div>
            </div>

            <div class="bg-amber-50 border border-amber-200 rounded-lg p-6">
              <h4 class="text-amber-800 font-semibold mb-3">‚ö†Ô∏è Important Note</h4>
              <p class="text-amber-700">
                Disabling essential cookies may affect the functionality of our website. 
                Some features may not work properly if cookies are blocked.
              </p>
            </div>
          </LegalSection>

          <!-- Section 5: Third-Party Cookies -->
          <LegalSection 
            client:load
            id="third-party-cookies"
            title="5. Third-Party Cookies"
            icon="üîó"
          >
            <p>
              Some cookies on our website are set by third-party services we use to enhance functionality:
            </p>

            <div class="space-y-4 my-6">
              
              <div class="border border-gray-200 rounded-lg p-6">
                <div class="flex items-center mb-3">
                  <div class="w-8 h-8 bg-gradient-to-r from-blue-500 to-green-500 rounded mr-3 flex items-center justify-center">
                    <span class="text-white text-xs font-bold">GA</span>
                  </div>
                  <h4 class="text-lg font-semibold">Google Analytics</h4>
                </div>
                <p class="text-gray-600 mb-3">
                  Helps us understand how visitors use our website to improve user experience.
                </p>
                <div class="flex items-center text-sm">
                  <span class="text-gray-500 mr-4">Purpose: Analytics</span>
                  <a 
                    href="https://policies.google.com/privacy" 
                    target="_blank" 
                    rel="noopener noreferrer"
                    class="text-blue-600 hover:text-blue-800 underline"
                  >
                    Privacy Policy ‚Üí
                  </a>
                </div>
              </div>

              <div class="border border-gray-200 rounded-lg p-6">
                <div class="flex items-center mb-3">
                  <div class="w-8 h-8 bg-gradient-to-r from-purple-500 to-pink-500 rounded mr-3 flex items-center justify-center">
                    <span class="text-white text-xs font-bold">CF</span>
                  </div>
                  <h4 class="text-lg font-semibold">Cloudflare</h4>
                </div>
                <p class="text-gray-600 mb-3">
                  Provides security, performance optimization, and content delivery services.
                </p>
                <div class="flex items-center text-sm">
                  <span class="text-gray-500 mr-4">Purpose: Security & Performance</span>
                  <a 
                    href="https://www.cloudflare.com/privacy/" 
                    target="_blank" 
                    rel="noopener noreferrer"
                    class="text-blue-600 hover:text-blue-800 underline"
                  >
                    Privacy Policy ‚Üí
                  </a>
                </div>
              </div>

            </div>

            <h3>Opting Out of Third-Party Cookies</h3>
            <p>
              You can opt out of third-party cookies by visiting the respective privacy policy 
              links above or by using browser settings to block third-party cookies entirely.
            </p>
          </LegalSection>

          <!-- Section 6: Your Rights -->
          <LegalSection 
            client:load
            id="your-rights"
            title="6. Your Rights and Choices"
            icon="‚öñÔ∏è"
          >
            <p>Under applicable privacy laws, you have several rights regarding cookies:</p>

            <div class="grid md:grid-cols-2 gap-6 my-6">
              
              <div class="bg-green-50 border border-green-200 rounded-lg p-6">
                <h4 class="text-green-800 font-semibold mb-3">‚úÖ Your Rights Include</h4>
                <ul class="text-green-700 space-y-2 text-sm">
                  <li>‚Ä¢ Right to be informed about cookie usage</li>
                  <li>‚Ä¢ Right to control non-essential cookies</li>
                  <li>‚Ä¢ Right to withdraw consent at any time</li>
                  <li>‚Ä¢ Right to access information about cookies</li>
                  <li>‚Ä¢ Right to delete cookies from your device</li>
                </ul>
              </div>

              <div class="bg-blue-50 border border-blue-200 rounded-lg p-6">
                <h4 class="text-blue-800 font-semibold mb-3">üõ°Ô∏è How to Exercise Your Rights</h4>
                <ul class="text-blue-700 space-y-2 text-sm">
                  <li>‚Ä¢ Use our cookie preference center</li>
                  <li>‚Ä¢ Adjust your browser settings</li>
                  <li>‚Ä¢ Contact us directly for assistance</li>
                  <li>‚Ä¢ Clear cookies manually from your browser</li>
                  <li>‚Ä¢ Use privacy-focused browser extensions</li>
                </ul>
              </div>

            </div>

            <div class="bg-gray-50 border border-gray-200 rounded-lg p-6">
              <h4 class="font-semibold mb-3">üìû Need Help?</h4>
              <p class="text-gray-600 mb-3">
                If you have questions about our cookie policy or need assistance managing your preferences:
              </p>
              <div class="flex flex-wrap gap-4">
                <a 
                  href="mailto:{BUSINESS_INFO.contact.email}" 
                  class="inline-flex items-center text-blue-600 hover:text-blue-800"
                >
                  <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
                  </svg>
                  {BUSINESS_INFO.contact.email}
                </a>
                <a 
                  href="/contact" 
                  class="inline-flex items-center text-blue-600 hover:text-blue-800"
                >
                  <svg class="w-4 h-4 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                    <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-3.582 8-8 8a8.959 8.959 0 01-2.4-.32l-3.6 1.2 1.2-3.6A8.959 8.959 0 013 12c0-4.418 3.582-8 8-8s8 3.582 8 8z"/>
                  </svg>
                  Contact Form
                </a>
              </div>
            </div>
          </LegalSection>

          <!-- Section 7: Updates to This Policy -->
          <LegalSection 
            client:load
            id="policy-updates"
            title="7. Updates to This Policy"
            icon="üîÑ"
          >
            <p>
              We may update this cookie policy from time to time to reflect changes in our 
              practices or for legal, operational, or regulatory reasons.
            </p>

            <div class="bg-indigo-50 border border-indigo-200 rounded-lg p-6 my-6">
              <h4 class="text-indigo-800 font-semibold mb-3">üìÖ Policy Updates</h4>
              <div class="text-indigo-700 space-y-2">
                <p><strong>How we notify you:</strong></p>
                <ul class="ml-4 space-y-1">
                  <li>‚Ä¢ Email notification for significant changes</li>
                  <li>‚Ä¢ Website banner for 30 days after updates</li>
                  <li>‚Ä¢ Updated "Last modified" date at the top of this page</li>
                </ul>
              </div>
            </div>

            <h3>Staying Informed</h3>
            <p>
              We recommend reviewing this policy periodically to stay informed about our 
              cookie practices. Continued use of our website after policy changes indicates 
              your acceptance of the updated terms.
            </p>
          </LegalSection>

          <!-- Section 8: Contact Information -->
          <LegalSection 
            client:load
            id="contact-info"
            title="8. Contact Information"
            icon="üìß"
            highlight={true}
          >
            <p>
              If you have any questions about this cookie policy or our privacy practices, 
              please don't hesitate to contact us:
            </p>

            <div class="grid md:grid-cols-2 gap-6 my-6">
              
              <div class="bg-white border border-gray-200 rounded-lg p-6 shadow-sm">
                <h4 class="font-semibold mb-4 text-gray-900">üìû Contact Details</h4>
                <div class="space-y-3">
                  <div class="flex items-center">
                    <svg class="w-5 h-5 text-gray-400 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 8l7.89 4.26a2 2 0 002.22 0L21 8M5 19h14a2 2 0 002-2V7a2 2 0 00-2-2H5a2 2 0 00-2 2v10a2 2 0 002 2z"/>
                    </svg>
                    <a href="mailto:{BUSINESS_INFO.contact.email}" class="text-blue-600 hover:text-blue-800">
                      {BUSINESS_INFO.contact.email}
                    </a>
                  </div>
                  
                  <div class="flex items-center">
                    <svg class="w-5 h-5 text-gray-400 mr-3" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                      <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 5a2 2 0 012-2h3.28a1 1 0 01.948.684l1.498 4.493a1 1 0 01-.502 1.21l-2.257 1.13a11.042 11.042 0 005.516 5.516l1.13-2.257a1 1 0 011.21-.502l4.493 1.498a1 1 0 01.684.949V19a2 2 0 01-2 2h-1C9.716 21 3 14.284 3 6V5z"/>
                    </svg>
                    <a href="tel:{BUSINESS_INFO.contact.phone}" class="text-blue-600 hover:text-blue-800">
                      {BUSINESS_INFO.contact.phone}
                    </a>
                  </div>
                </div>
              </div>

              <div class="bg-white border border-gray-200 rounded-lg p-6 shadow-sm">
                <h4 class="font-semibold mb-4 text-gray-900">üïê Response Time</h4>
                <div class="space-y-2 text-sm text-gray-600">
                  <p><strong>General inquiries:</strong> Within 48 hours</p>
                  <p><strong>Privacy concerns:</strong> Within 24 hours</p>
                  <p><strong>Technical issues:</strong> Within 12 hours</p>
                </div>
              </div>

            </div>

            <div class="text-center">
              <a 
                href="/contact" 
                class="inline-flex items-center px-6 py-3 bg-gradient-to-r from-blue-600 to-indigo-600 text-white rounded-lg hover:from-blue-700 hover:to-indigo-700 transition-all duration-300 font-medium"
              >
                <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                  <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 12h.01M12 12h.01M16 12h.01M21 12c0 4.418-3.582 8-8 8a8.959 8.959 0 01-2.4-.32l-3.6 1.2 1.2-3.6A8.959 8.959 0 013 12c0-4.418 3.582-8 8-8s8 3.582 8 8z"/>
                </svg>
                Get in Touch
              </a>
            </div>
          </LegalSection>

        </div>
      </div>
    </section>

  </main>

  <!-- Cookie Settings Modal -->
  <div id="cookieModal" class="fixed inset-0 bg-black bg-opacity-50 hidden z-50 flex items-center justify-center p-4">
    <div class="bg-white rounded-lg max-w-2xl w-full max-h-[90vh] overflow-y-auto">
      <div class="p-6">
        <div class="flex justify-between items-center mb-4">
          <h3 class="text-xl font-bold text-gray-900">Cookie Settings</h3>
          <button onclick="closeCookieModal()" class="text-gray-400 hover:text-gray-600">
            <svg class="w-6 h-6" fill="none" stroke="currentColor" viewBox="0 0 24 24">
              <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"/>
            </svg>
          </button>
        </div>
        
        <p class="text-gray-600 mb-6">
          Manage your cookie preferences below. Some cookies are essential for the website to function.
        </p>

        <div class="space-y-4">
          <!-- Essential Cookies -->
          <div class="border border-gray-200 rounded-lg p-4">
            <div class="flex justify-between items-center mb-2">
              <h4 class="font-semibold text-gray-900">Essential Cookies</h4>
              <div class="bg-gray-100 px-3 py-1 rounded-full text-sm text-gray-600">
                Always Active
              </div>
            </div>
            <p class="text-sm text-gray-600 mb-3">
              These cookies are necessary for the website to function and cannot be switched off.
            </p>
            <div class="text-xs text-gray-500">
              Includes: Session management, security tokens, form submissions
            </div>
          </div>

          <!-- Analytics Cookies -->
          <div class="border border-gray-200 rounded-lg p-4">
            <div class="flex justify-between items-center mb-2">
              <h4 class="font-semibold text-gray-900">Analytics Cookies</h4>
              <label class="relative inline-flex items-center cursor-pointer">
                <input type="checkbox" id="analytics-toggle" class="sr-only peer" onchange="toggleAnalytics()">
                <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
              </label>
            </div>
            <p class="text-sm text-gray-600 mb-3">
              Help us understand how visitors use our website to improve user experience.
            </p>
            <div class="text-xs text-gray-500">
              Includes: Google Analytics, page views, session duration
            </div>
          </div>

          <!-- Performance Cookies -->
          <div class="border border-gray-200 rounded-lg p-4">
            <div class="flex justify-between items-center mb-2">
              <h4 class="font-semibold text-gray-900">Performance Cookies</h4>
              <label class="relative inline-flex items-center cursor-pointer">
                <input type="checkbox" id="performance-toggle" class="sr-only peer" onchange="togglePerformance()">
                <div class="w-11 h-6 bg-gray-200 peer-focus:outline-none peer-focus:ring-4 peer-focus:ring-blue-300 rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-blue-600"></div>
              </label>
            </div>
            <p class="text-sm text-gray-600 mb-3">
              Used to enhance the performance and functionality of our website.
            </p>
            <div class="text-xs text-gray-500">
              Includes: Load time tracking, error monitoring
            </div>
          </div>
        </div>

        <div class="flex flex-col sm:flex-row gap-3 mt-6 pt-6 border-t border-gray-200">
          <button 
            onclick="acceptAllCookies()" 
            class="flex-1 bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors font-medium"
          >
            Accept All
          </button>
          <button 
            onclick="savePreferences()" 
            class="flex-1 border border-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-50 transition-colors font-medium"
          >
            Save Preferences
          </button>
          <button 
            onclick="rejectAll()" 
            class="flex-1 text-gray-600 px-4 py-2 rounded-lg hover:bg-gray-50 transition-colors"
          >
            Reject All
          </button>
        </div>
      </div>
    </div>
  </div>

  <!-- Cookie Banner (for initial visit) -->
  <div id="cookieBanner" class="fixed bottom-0 left-0 right-0 bg-white border-t border-gray-200 shadow-lg p-4 z-40 hidden">
    <div class="max-w-6xl mx-auto flex flex-col md:flex-row items-start md:items-center justify-between gap-4">
      <div class="flex-1">
        <p class="text-sm text-gray-700">
          We use cookies to enhance your browsing experience and analyze our traffic. 
          <a href="/cookies" class="text-blue-600 hover:text-blue-800 underline">Learn more</a>
        </p>
      </div>
      <div class="flex flex-wrap gap-2">
        <button 
          onclick="openCookieModal()" 
          class="text-sm border border-gray-300 text-gray-700 px-4 py-2 rounded-lg hover:bg-gray-50 transition-colors"
        >
          Customize
        </button>
        <button 
          onclick="acceptAllCookies()" 
          class="text-sm bg-blue-600 text-white px-4 py-2 rounded-lg hover:bg-blue-700 transition-colors"
        >
          Accept All
        </button>
      </div>
    </div>
  </div>

  <script define:vars={{ GA_MEASUREMENT_ID }}>
    // Cookie consent functionality
    if (typeof window !== 'undefined') {
      
      // Cookie utility functions
      function setCookie(name, value, days) {
        const expires = new Date();
        expires.setTime(expires.getTime() + (days * 24 * 60 * 60 * 1000));
        document.cookie = `${name}=${value};expires=${expires.toUTCString()};path=/;SameSite=Lax`;
      }
      
      function getCookie(name) {
        const nameEQ = name + "=";
        const ca = document.cookie.split(';');
        for(let i = 0; i < ca.length; i++) {
          let c = ca[i];
          while (c.charAt(0) === ' ') c = c.substring(1, c.length);
          if (c.indexOf(nameEQ) === 0) return c.substring(nameEQ.length, c.length);
        }
        return null;
      }
      
      function deleteCookie(name) {
        document.cookie = `${name}=; expires=Thu, 01 Jan 1970 00:00:00 UTC; path=/;`;
      }

      // Clear all Google Analytics cookies
      function clearAnalyticsCookies() {
        const cookiesToDelete = ['_ga', '_ga_' + GA_MEASUREMENT_ID.replace('G-', ''), '_gid', '_gat'];
        cookiesToDelete.forEach(deleteCookie);
        
        // Also try to delete any _ga_* cookies by checking all cookies
        document.cookie.split(';').forEach(cookie => {
          const cookieName = cookie.split('=')[0].trim();
          if (cookieName.startsWith('_ga')) {
            deleteCookie(cookieName);
          }
        });
      }

      // Cookie consent state
      let cookieConsent = {
        analytics: false,
        performance: false
      };

      // Load existing preferences
      function loadCookiePreferences() {
        const consent = getCookie('cookie-consent');
        if (consent) {
          try {
            cookieConsent = JSON.parse(consent);
            updateToggleStates();
            loadAnalytics();
          } catch (e) {
            console.error('Error parsing cookie consent:', e);
          }
        } else {
          // Show banner if no consent recorded
          document.getElementById('cookieBanner').classList.remove('hidden');
        }
      }

      // Update toggle states in modal
      function updateToggleStates() {
        const analyticsToggle = document.getElementById('analytics-toggle');
        const performanceToggle = document.getElementById('performance-toggle');
        
        if (analyticsToggle) analyticsToggle.checked = cookieConsent.analytics;
        if (performanceToggle) performanceToggle.checked = cookieConsent.performance;
      }

      // Save preferences
      function savePreferences() {
        setCookie('cookie-consent', JSON.stringify(cookieConsent), 365);
        closeCookieModal();
        hideCookieBanner();
        
        if (cookieConsent.analytics) {
          loadAnalytics();
        } else {
          clearAnalyticsCookies();
        }
        
        showNotification('Cookie preferences saved');
      }

      // Accept all cookies
      function acceptAllCookies() {
        cookieConsent = {
          analytics: true,
          performance: true
        };
        savePreferences();
      }

      // Reject all non-essential cookies
      function rejectAll() {
        cookieConsent = {
          analytics: false,
          performance: false
        };
        
        // Clear existing analytics cookies
        clearAnalyticsCookies();
        
        savePreferences();
      }

      // Toggle functions
      function toggleAnalytics() {
        cookieConsent.analytics = document.getElementById('analytics-toggle').checked;
      }

      function togglePerformance() {
        cookieConsent.performance = document.getElementById('performance-toggle').checked;
      }

      // Modal functions
      function openCookieModal() {
        updateToggleStates();
        document.getElementById('cookieModal').classList.remove('hidden');
        document.body.style.overflow = 'hidden';
      }

      function closeCookieModal() {
        document.getElementById('cookieModal').classList.add('hidden');
        document.body.style.overflow = 'auto';
      }

      function hideCookieBanner() {
        document.getElementById('cookieBanner').classList.add('hidden');
      }

      // Load analytics if consent given
      function loadAnalytics() {
        if (cookieConsent.analytics && GA_MEASUREMENT_ID && GA_MEASUREMENT_ID !== 'GA_MEASUREMENT_ID') {
          // Load Google Analytics
          if (typeof gtag === 'undefined') {
            const script = document.createElement('script');
            script.async = true;
            script.src = `https://www.googletagmanager.com/gtag/js?id=${GA_MEASUREMENT_ID}`;
            document.head.appendChild(script);
            
            script.onload = function() {
              window.dataLayer = window.dataLayer || [];
              function gtag(){dataLayer.push(arguments);}
              gtag('js', new Date());
              gtag('config', GA_MEASUREMENT_ID, {
                anonymize_ip: true,
                cookie_flags: 'SameSite=Lax;Secure'
              });
              window.gtag = gtag;
            };
          }
        }
      }

      // Show notification
      function showNotification(message) {
        const notification = document.createElement('div');
        notification.className = 'fixed top-4 right-4 bg-green-600 text-white px-4 py-2 rounded-lg shadow-lg z-50 transition-all duration-300';
        notification.textContent = message;
        document.body.appendChild(notification);
        
        // Animate in
        setTimeout(() => {
          notification.style.transform = 'translateX(0)';
          notification.style.opacity = '1';
        }, 100);
        
        // Remove after 3 seconds
        setTimeout(() => {
          notification.style.transform = 'translateX(100%)';
          notification.style.opacity = '0';
          setTimeout(() => {
            notification.remove();
          }, 300);
        }, 3000);
      }

      // Make functions global
      window.openCookieModal = openCookieModal;
      window.closeCookieModal = closeCookieModal;
      window.acceptAllCookies = acceptAllCookies;
      window.rejectAll = rejectAll;
      window.savePreferences = savePreferences;
      window.toggleAnalytics = toggleAnalytics;
      window.togglePerformance = togglePerformance;

      // Legacy support for existing button
      window.cookieConsent = {
        showPreferences: openCookieModal
      };

      // Initialize on page load
      document.addEventListener('DOMContentLoaded', loadCookiePreferences);
      
      // Close modal when clicking outside
      document.getElementById('cookieModal').addEventListener('click', function(e) {
        if (e.target === this) {
          closeCookieModal();
        }
      });
    }
  </script>

</Layout>